{
  "swagger": "2.0",
  "info": {
      "title": "Security Insights",
      "description": "API spec for Microsoft.SecurityInsights (Azure Security Insights) resource provider",
      "version": "2025-01-01-preview"
  },
  "paths": {
      "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/collaborativeAggregations/{collaborativeAggregationName}": {
          "put": {
              "tags": [
                  "collaborativeAggregations"
              ],
              "description": "Upserts Collaborative Aggregation",
              "operationId": "PutCollaborativeAggregation",
              "consumes": [
                  "application/json"
              ],
              "produces": [
                  "application/json"
              ],
              "parameters": [
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/SubscriptionIdParameter"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ResourceGroupNameParameter"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/WorkspaceName"
                  },
                  {
                      "in": "path",
                      "name": "collaborativeAggregationName",
                      "required": true,
                      "type": "string"
                  },
                  {
                      "in": "header",
                      "name": "x-ms-client-workspace-id",
                      "type": "string",
                      "format": "uuid"
                  },
                  {
                      "in": "header",
                      "name": "x-ms-client-object-id",
                      "type": "string",
                      "format": "uuid"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ApiVersionParameter"
                  },
                  {
                      "in": "body",
                      "name": "collaborativeAggregationToUpsert",
                      "schema": {
                          "$ref": "#/definitions/CollaborativeAggregationArmModelArmObjectWrapper"
                      }
                  }
              ],
              "responses": {
                  "200": {
                      "description": "OK",
                      "schema": {
                          "$ref": "#/definitions/CollaborativeAggregationArmModelArmObjectWrapper"
                      }
                  },
                  "201": {
                      "description": "Created",
                      "schema": {
                          "$ref": "#/definitions/CollaborativeAggregationArmModelArmObjectWrapper"
                      }
                  },
                  "default": {
                      "description": "Error response describing why the operation failed.",
                      "schema": {
                          "$ref": "../../../common/2.0/types.json#/definitions/CloudError"
                      }
                  }
              },
              "x-ms-examples": {
                  "PutCollaborativeAggregation": {
                      "$ref": "./examples/collaborativeAggregations/PutCollaborativeAggregation.json"
                  }
              }
          },
          "get": {
              "tags": [
                  "collaborativeAggregations"
              ],
              "description": "Gets Collaborative Aggregation by name.",
              "operationId": "GetCollaborativeAggregation",
              "produces": [
                  "application/json"
              ],
              "parameters": [
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/SubscriptionIdParameter"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ResourceGroupNameParameter"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/WorkspaceName"
                  },
                  {
                      "in": "path",
                      "name": "collaborativeAggregationName",
                      "required": true,
                      "type": "string"
                  },
                  {
                      "in": "header",
                      "name": "x-ms-client-workspace-id",
                      "type": "string",
                      "format": "uuid"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ApiVersionParameter"
                  }
              ],
              "responses": {
                  "200": {
                      "description": "OK",
                      "schema": {
                          "$ref": "#/definitions/CollaborativeAggregationArmModelArmObjectWrapper"
                      }
                  },
                  "default": {
                      "description": "Error response describing why the operation failed.",
                      "schema": {
                          "$ref": "../../../common/2.0/types.json#/definitions/CloudError"
                      }
                  }
              },
              "x-ms-examples": {
                  "GetCollaborativeAggregation": {
                      "$ref": "./examples/collaborativeAggregations/GetCollaborativeAggregation.json"
                  }
              }
          },
          "delete": {
              "tags": [
                  "collaborativeAggregations"
              ],
              "description": "Delete Collaborative Aggregation",
              "operationId": "DeleteCollaborativeAggregation",
              "produces": [
                  "application/json"
              ],
              "parameters": [
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/SubscriptionIdParameter"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ResourceGroupNameParameter"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/WorkspaceName"
                  },
                  {
                      "in": "path",
                      "name": "collaborativeAggregationName",
                      "required": true,
                      "type": "string"
                  },
                  {
                      "in": "header",
                      "name": "x-ms-client-workspace-id",
                      "type": "string",
                      "format": "uuid"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ApiVersionParameter"
                  }
              ],
              "responses": {
                  "202": {
                      "description": "Accepted"
                  },
                  "204": {
                      "description": "NoContent"
                  },
                  "default": {
                      "description": "Error response describing why the operation failed.",
                      "schema": {
                          "$ref": "../../../common/2.0/types.json#/definitions/CloudError"
                      }
                  }
              },
              "x-ms-examples": {
                  "DeleteCollaborativeAggregation": {
                      "$ref": "./examples/collaborativeAggregations/DeleteCollaborativeAggregation.json"
                  }
              }
          }
      },
      "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/collaborativeAggregations": {
          "get": {
              "tags": [
                  "collaborativeAggregations"
              ],
              "description": "Gets all Collaborative Aggregations",
              "operationId": "GetAllCollaborativeAggregations",
              "produces": [
                  "application/json"
              ],
              "parameters": [
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/SubscriptionIdParameter"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ResourceGroupNameParameter"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/WorkspaceName"
                  },
                  {
                      "in": "header",
                      "name": "x-ms-client-workspace-id",
                      "type": "string",
                      "format": "uuid"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ApiVersionParameter"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/ODataFilter"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/ODataOrderBy"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/ODataSkipToken"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/ODataTop"
                  }
              ],
              "responses": {
                  "200": {
                      "description": "OK",
                      "schema": {
                          "$ref": "#/definitions/CollaborativeAggregationArmModelArmCollectionWrapper"
                      }
                  },
                  "default": {
                      "description": "Error response describing why the operation failed.",
                      "schema": {
                          "$ref": "../../../common/2.0/types.json#/definitions/CloudError"
                      }
                  }
              },
              "x-ms-examples": {
                  "GetAllCollaborativeAggregations": {
                      "$ref": "./examples/collaborativeAggregations/GetAllCollaborativeAggregations.json"
                  }
              }
          }
      },
      "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/collaborativeAggregationSources/{collaborativeAggregationSourceName}": {
          "patch": {
              "tags": [
                  "collaborativeAggregationSources"
              ],
              "description": "Patch Collaborative Aggregation Source",
              "operationId": "PatchCollaborativeAggregationSource",
              "consumes": [
                  "application/json"
              ],
              "produces": [
                  "application/json"
              ],
              "parameters": [
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/SubscriptionIdParameter"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ResourceGroupNameParameter"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/WorkspaceName"
                  },
                  {
                      "in": "path",
                      "name": "collaborativeAggregationSourceName",
                      "required": true,
                      "type": "string"
                  },
                  {
                      "in": "header",
                      "name": "x-ms-client-workspace-id",
                      "type": "string",
                      "format": "uuid"
                  },
                  {
                      "in": "header",
                      "name": "x-ms-client-object-id",
                      "type": "string",
                      "format": "uuid"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ApiVersionParameter"
                  },
                  {
                      "in": "body",
                      "name": "collaborativeAggregationSourceToUpsert",
                      "schema": {
                          "$ref": "#/definitions/CollaborativeAggregationSourceArmModelArmObjectWrapper"
                      }
                  }
              ],
              "responses": {
                  "202": {
                      "description": "Accepted",
                      "schema": {
                          "$ref": "#/definitions/CollaborativeAggregationSourceArmModelArmObjectWrapper"
                      }
                  },
                  "default": {
                      "description": "Error response describing why the operation failed.",
                      "schema": {
                          "$ref": "../../../common/2.0/types.json#/definitions/CloudError"
                      }
                  }
              }
          },
          "get": {
              "tags": [
                  "collaborativeAggregationSources"
              ],
              "description": "Get Collaborative Aggregation Source by name",
              "operationId": "GetCollaborativeAggregationSource",
              "produces": [
                  "application/json"
              ],
              "parameters": [
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/SubscriptionIdParameter"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ResourceGroupNameParameter"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/WorkspaceName"
                  },
                  {
                      "in": "path",
                      "name": "collaborativeAggregationSourceName",
                      "required": true,
                      "type": "string"
                  },
                  {
                      "in": "header",
                      "name": "x-ms-client-workspace-id",
                      "type": "string",
                      "format": "uuid"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ApiVersionParameter"
                  }
              ],
              "responses": {
                  "200": {
                      "description": "OK",
                      "schema": {
                          "$ref": "#/definitions/CollaborativeAggregationSourceArmModelArmObjectWrapper"
                      }
                  },
                  "default": {
                      "description": "Error response describing why the operation failed.",
                      "schema": {
                          "$ref": "../../../common/2.0/types.json#/definitions/CloudError"
                      }
                  }
              }
          },
          "delete": {
              "tags": [
                  "collaborativeAggregationSources"
              ],
              "description": "Delete Collaborative Aggregation Source",
              "operationId": "DeleteCollaborativeAggregationSource",
              "produces": [
                  "application/json"
              ],
              "parameters": [
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/SubscriptionIdParameter"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ResourceGroupNameParameter"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/WorkspaceName"
                  },
                  {
                      "in": "path",
                      "name": "collaborativeAggregationSourceName",
                      "required": true,
                      "type": "string"
                  },
                  {
                      "in": "header",
                      "name": "x-ms-client-workspace-id",
                      "type": "string",
                      "format": "uuid"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ApiVersionParameter"
                  }
              ],
              "responses": {
                  "202": {
                      "description": "Accepted"
                  },
                  "204": {
                      "description": "NoContent"
                  },
                  "default": {
                      "description": "Error response describing why the operation failed.",
                      "schema": {
                          "$ref": "../../../common/2.0/types.json#/definitions/CloudError"
                      }
                  }
              }
          }
      },
      "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/collaborativeAggregationSources": {
          "get": {
              "tags": [
                  "collaborativeAggregationSources"
              ],
              "description": "Get all Collaborative Aggregation Sources",
              "operationId": "GetAllCollaborativeAggregationSources",
              "produces": [
                  "application/json"
              ],
              "parameters": [
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/SubscriptionIdParameter"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ResourceGroupNameParameter"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/WorkspaceName"
                  },
                  {
                      "in": "header",
                      "name": "x-ms-client-workspace-id",
                      "type": "string",
                      "format": "uuid"
                  },
                  {
                      "$ref": "../../../../../common-types/resource-management/v3/types.json#/parameters/ApiVersionParameter"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/ODataFilter"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/ODataOrderBy"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/ODataSkipToken"
                  },
                  {
                      "$ref": "../../../common/2.0/types.json#/parameters/ODataTop"
                  }
              ],
              "responses": {
                  "200": {
                      "description": "OK",
                      "schema": {
                          "$ref": "#/definitions/CollaborativeAggregationSourceArmModelArmCollectionWrapper"
                      }
                  },
                  "default": {
                      "description": "Error response describing why the operation failed.",
                      "schema": {
                          "$ref": "../../../common/2.0/types.json#/definitions/CloudError"
                      }
                  }
              }
          }
      }
  },
  "definitions": {
      "ApprovalStatusArmType": {
          "enum": [
              "Pending",
              "Approved",
              "Rejected",
              "Revoked"
          ],
          "type": "string",
          "example": "Pending",
          "x-ms-enum": {
              "name": "ApprovalStatusArmType",
              "modelAsString": true,
              "values": [
                  {
                      "value": "Pending"
                  },
                  {
                      "value": "Approved"
                  },
                  {
                      "value": "Rejected"
                  },
                  {
                      "value": "Revoked"
                  }
              ]
          }
      },
      "CollaborativeAggregationArmModel": {
          "required": [
              "sourcePartnershipInformation"
          ],
          "type": "object",
          "properties": {
              "displayName": {
                  "type": "string"
              },
              "description": {
                  "type": "string"
              },
              "sourcePartnershipInformation": {
                  "$ref": "#/definitions/CollaboratorPartnershipInformationArmModel"
              },
              "dataSourceType": {
                  "$ref": "#/definitions/DataSourceArmType"
              },
              "aggregationFilters": {
                  "type": "array",
                  "items": {
                      "$ref": "#/definitions/FilterConditionBaseArmModel"
                  }
              },
              "isEnabled": {
                  "type": "boolean"
              },
              "approvalStatus": {
                  "type": "object",
                  "readOnly": true,
                  "$ref": "#/definitions/ApprovalStatusArmType"
              }
          }
      },
      "CollaborativeAggregationArmModelArmCollectionWrapper": {
          "type": "object",
          "properties": {
              "value": {
                  "type": "array",
                  "items": {
                      "$ref": "#/definitions/CollaborativeAggregationArmModelArmObjectWrapper"
                  }
              },
              "nextLink": {
                  "type": "string"
              }
          }
      },
      "CollaborativeAggregationArmModelArmObjectWrapper": {
          "required": [
              "properties"
          ],
          "type": "object",
          "allOf": [
              {
                  "$ref": "../../../common/2.0/types.json#/definitions/ResourceWithEtag"
              }
          ],
          "properties": {
              "properties": {
                  "type": "object",
                  "$ref": "#/definitions/CollaborativeAggregationArmModel",
                  "x-ms-client-flatten": true
              }
          }
      },
      "CollaborativeAggregationSourceArmModel": {
          "type": "object",
          "properties": {
              "displayName": {
                  "type": "string"
              },
              "description": {
                  "type": "string"
              },
              "approvalStatus": {
                  "$ref": "#/definitions/ApprovalStatusArmType"
              },
              "targetPartnershipInformation": {
                  "type": "object",
                  "readOnly": true,
                  "$ref": "#/definitions/CollaboratorPartnershipInformationArmModel"
              },
              "dataSourceType": {
                  "type": "object",
                  "readOnly": true,
                  "$ref": "#/definitions/DataSourceArmType"
              }
          }
      },
      "CollaborativeAggregationSourceArmModelArmCollectionWrapper": {
          "type": "object",
          "properties": {
              "value": {
                  "type": "array",
                  "items": {
                      "$ref": "#/definitions/CollaborativeAggregationSourceArmModelArmObjectWrapper"
                  }
              },
              "nextLink": {
                  "type": "string"
              }
          }
      },
      "CollaborativeAggregationSourceArmModelArmObjectWrapper": {
          "required": [
              "properties"
          ],
          "type": "object",
          "allOf": [
              {
                  "$ref": "../../../common/2.0/types.json#/definitions/ResourceWithEtag"
              }
          ],
          "properties": {
              "properties": {
                  "type": "object",
                  "$ref": "#/definitions/CollaborativeAggregationSourceArmModel",
                  "x-ms-client-flatten": true
              }
          }
      },
      "CollaboratorPartnershipInformationArmModel": {
          "required": [
              "id"
          ],
          "type": "object",
          "properties": {
              "id": {
                  "minLength": 1,
                  "type": "string"
              },
              "displayName": {
                  "type": "string",
                  "readOnly": true
              }
          }
      },
      "DataSourceArmType": {
          "enum": [
              "SecurityAlertsTable"
          ],
          "type": "string",
          "example": "SecurityAlertsTable",
          "x-ms-enum": {
              "name": "DataSourceArmType",
              "modelAsString": true,
              "values": [
                  {
                      "value": "SecurityAlertsTable"
                  }
              ]
          }
      },
      "FilterConditionArmType": {
          "enum": [
              "Property"
          ],
          "type": "string",
          "example": "Property",
          "x-ms-enum": {
              "name": "FilterConditionArmType",
              "modelAsString": true,
              "values": [
                  {
                      "value": "Property"
                  }
              ]
          }
      },
      "FilterConditionBaseArmModel": {
          "type": "object",
          "properties": {
              "conditionType": {
                  "$ref": "#/definitions/FilterConditionArmType"
              }
          }
      }
  },
  "securityDefinitions": {
      "azure_auth": {
          "type": "oauth2",
          "flow": "implicit",
          "authorizationUrl": "https://login.microsoftonline.com/common/oauth2/authorize",
          "scopes": {
              "user_impersonation": "impersonate your user account"
          },
          "description": "Azure Active Directory OAuth2 Flow"
      }
  },
  "security": [
      {
          "azure_auth": [
              "user_impersonation"
          ]
      }
  ],
  "host": "management.azure.com",
  "schemes": [
      "https"
  ],
  "produces": [
      "application/json"
  ],
  "consumes": [
      "application/json"
  ]
}
